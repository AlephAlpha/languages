stages: [init, build]

# template used for building docker images
.base:
  stage: build
  # TODO: add special tag to ensure the same runner is used for all jobs in this pipeline
  tags: [Linux, shell_executor]
  rules:
    - if: $CI_PIPELINE_SOURCE == "schedule"

init:
  extends: .base
  stage: init
  script:
    - podman login "$CI_REGISTRY" -u "$CI_REGISTRY_USER" --password-stdin <<<"$CI_REGISTRY_PASSWORD"

include:
  # generated by gen_ci_config.py
  - local: .images.gitlab-ci.yml
